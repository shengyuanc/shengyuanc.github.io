<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯æ„›é¢¨ç›´æ’­è·‘é¦¬ç‡ˆ</title>
    <!-- å¼•å…¥å¯æ„›çš„åœ“é«”å­—å‹ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700&display=swap" rel="stylesheet">

    <style>
        /* OBS èƒŒæ™¯è¨­å®šï¼š
           é€™è¨­ç‚ºé€æ˜ï¼Œé€™æ¨£åœ¨ OBS è£¡é€™å±¤ç¶²é èƒŒæ™¯å°±æ˜¯é€æ˜çš„ï¼Œåªçœ‹å¾—åˆ°è·‘é¦¬ç‡ˆæ¢ 
        */
        body {
            margin: 0;
            padding: 0;
            background-color: transparent; 
            font-family: 'Zen Maru Gothic', sans-serif;
            overflow: hidden; /* é˜²æ­¢å‡ºç¾æ²è»¸ */
            height: 100vh;
            display: flex;
            align-items: flex-end; /* é è¨­æ”¾åœ¨åº•éƒ¨ï¼Œå¯è‡ªè¡Œèª¿æ•´ */
        }

        /* è·‘é¦¬ç‡ˆå¤–æ¡†å®¹å™¨ */
        .ticker-container {
            width: 100%;
            /* æ©˜ç²‰è‰²æ¼¸å±¤èƒŒæ™¯ */
            background: linear-gradient(90deg, #FF9A9E 0%, #FECFEF 50%, #FF9A9E 100%);
            border-top: 3px solid #fff; /* ç¨å¾®è®Šç´°çš„é‚Šæ¡† */
            border-bottom: 3px solid #fff;
            box-shadow: 0 -4px 15px rgba(255, 105, 180, 0.4); /* æŸ”å’Œçš„ç²‰è‰²é™°å½± */
            height: 40px; /* å¾ 60px æ”¹ç‚º 40px */
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
            border-radius: 20px; /* åœ“è§’ç¨å¾®ç¸®å° */
            margin: 10px; /* ç•™ä¸€é»é‚Šè· */
        }

        /* è£é£¾ç”¨çš„å°åœ–ç¤º (å·¦å´å›ºå®š) */
        .badge {
            position: absolute;
            left: 8px;
            z-index: 10;
            background: #fff;
            color: #FF6B6B;
            padding: 2px 10px; /* å…§è·ç¸®å° */
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem; /* å­—é«”ç¸®å° */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* å¯¦éš›æ»¾å‹•çš„æ–‡å­—å€åŸŸ */
        .scrolling-text {
            white-space: nowrap;
            position: absolute;
            will-change: transform;
            animation: scroll-left 20s linear infinite; 
            color: #fff;
            font-size: 1.2rem; /* å­—é«”å¾ 1.5rem æ”¹ç‚º 1.2rem */
            font-weight: 700;
            text-shadow: 1px 1px 0px rgba(255, 107, 107, 0.5); /* é™°å½±ç¨å¾®ç¸®å° */
            display: flex;
            align-items: center;
        }

        /* æ²å‹•å‹•ç•«å®šç¾© */
        @keyframes scroll-left {
            0% {
                transform: translateX(100vw); /* å¾è¢å¹•æœ€å³é‚Šé–‹å§‹ */
            }
            100% {
                transform: translateX(-100%); /* æ»¾å‹•åˆ°æ–‡å­—å®Œå…¨æ¶ˆå¤±åœ¨å·¦é‚Š */
            }
        }

        /* åˆ†éš”ç¬¦è™Ÿæ¨£å¼ */
        .separator {
            margin: 0 20px;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>

    <div class="ticker-container">
        <!-- å·¦å´å›ºå®šçš„æ¨™é¡Œï¼Œä½ å¯ä»¥æ”¹æˆä½ çš„åå­—æˆ– "NEWS" -->
        <div class="badge">
            <span>ğŸ“¢</span> å…¬å‘Š
        </div>

        <!-- æ»¾å‹•å…§å®¹ -->
        <div class="scrolling-text" id="ticker-content">
            è¼‰å…¥ä¸­... ğŸŒ¸ è«‹ç¨å€™
        </div>
    </div>

    <script>
        // ================= è¨­å®šå€ =================

        // 1. æˆ‘å·²å¹«ä½ å°‡ç·¨è¼¯ç¶²å€è½‰æ›ç‚ºè³‡æ–™è®€å–ç¶²å€
        // â˜…â˜…â˜… é‡è¦ï¼šè«‹å‹™å¿…å°‡è©¦ç®—è¡¨æ¬Šé™è¨­ç‚ºã€ŒçŸ¥é“é€£çµçš„ä»»ä½•äººã€çš†å¯æª¢è¦– â˜…â˜…â˜…
        const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/1kaW3o3-LEyDr_Vs-9ykTIxi_-vEz5vn2f_mxK-s1UZo/gviz/tq?tqx=out:csv'; 

        // 2. å¦‚æœè®€å–å¤±æ•—æˆ–ç¶²å€ç‚ºç©ºï¼Œé¡¯ç¤ºé€™äº›é è¨­è¨Šæ¯
        const DEFAULT_MESSAGES = [
            "æ­¡è¿ä¾†åˆ°ç›´æ’­é–“ï¼è¨˜å¾—æŒ‰è®šè¨‚é–±å–”ï¼",
            "ä»Šå¤©æ˜¯è¼•é¬†èŠå¤©çš„é¢¨æ ¼ï½",
            "é»æ­Œè«‹çœ‹æŒ‡ä»¤èªªæ˜",
            "æ„Ÿè¬å¤§å®¶çš„æ”¶çœ‹ (Â´â–½`Êƒâ™¡Æª)"
        ];

        // 3. è¨Šæ¯ä¹‹é–“çš„åˆ†éš”ç¬¦è™Ÿ (å¯ä»¥æ˜¯è¡¨æƒ…ç¬¦è™Ÿ)
        const SEPARATOR = " ğŸŒ¸ ";

        // ================= ç¨‹å¼é‚è¼¯å€ (é€šå¸¸ä¸ç”¨æ”¹) =================

        async function fetchMessages() {
            const ticker = document.getElementById('ticker-content');
            
            if (!SHEET_CSV_URL) {
                console.log("æœªè¨­å®š CSV é€£çµï¼Œä½¿ç”¨é è¨­è¨Šæ¯");
                updateTicker(DEFAULT_MESSAGES);
                return;
            }

            try {
                const response = await fetch(SHEET_CSV_URL);
                if (!response.ok) throw new Error("ç¶²è·¯å›æ‡‰éŒ¯èª¤");
                
                const text = await response.text();
                const messages = parseCSV(text);
                
                if (messages.length > 0) {
                    updateTicker(messages);
                } else {
                    updateTicker(DEFAULT_MESSAGES);
                }

            } catch (error) {
                console.error("è®€å–è©¦ç®—è¡¨å¤±æ•—:", error);
                // å¤±æ•—æ™‚ä¿æŒåŸæ¨£æˆ–é¡¯ç¤ºé è¨­
                updateTicker(DEFAULT_MESSAGES);
            }
        }

        // ç°¡å–®çš„ CSV è§£æå™¨ (æŠ“å–ç¬¬ä¸€æ¬„)
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const result = [];
            
            // è·³éæ¨™é¡Œåˆ—? å¦‚æœä½ çš„è©¦ç®—è¡¨ç¬¬ä¸€è¡Œæ˜¯æ¨™é¡Œï¼Œå°‡ i = 0 æ”¹æˆ i = 1
            for (let i = 0; i < lines.length; i++) {
                // ç§»é™¤å‰å¾Œç©ºç™½èˆ‡å¼•è™Ÿ
                let line = lines[i].trim();
                // ç°¡å–®è™•ç† CSV å¼•è™Ÿ (å¦‚æœæœ‰çš„è©±)
                if (line.startsWith('"') && line.endsWith('"')) {
                    line = line.substring(1, line.length - 1);
                }
                
                if (line) {
                    result.push(line);
                }
            }
            return result;
        }

        function updateTicker(messages) {
            const ticker = document.getElementById('ticker-content');
            
            // å°‡æ‰€æœ‰è¨Šæ¯ä¸²æ¥èµ·ä¾†ï¼ŒåŠ ä¸Šåˆ†éš”ç¬¦è™Ÿ
            // ç§»é™¤äº†è‡ªå‹•é‡è¤‡çš„é‚è¼¯ï¼Œç¾åœ¨åªæœƒé¡¯ç¤ºä¸€æ¬¡
            let displayContent = messages.join(SEPARATOR);
            
            // åŠ ä¸Šçµå°¾åˆ†éš”ç¬¦è™Ÿï¼Œè®“å¾ªç’°çœ‹èµ·ä¾†æ›´è‡ªç„¶
            ticker.innerText = displayContent;
            
            // æ ¹æ“šæ–‡å­—é•·åº¦å‹•æ…‹èª¿æ•´å‹•ç•«é€Ÿåº¦ (å­—è¶Šå¤šï¼Œéœ€è¦çš„æ™‚é–“è¶Šé•·ï¼Œä¿æŒé€Ÿåº¦ä¸€è‡´)
            // åŸºç¤é€Ÿåº¦ï¼šå¾ 0.3 æ”¹ç‚º 0.6 (æ•¸å­—è¶Šå¤§ï¼Œæ™‚é–“è¶Šé•· = è¶Šæ…¢)
            const duration = Math.max(15, displayContent.length * 0.6);
            ticker.style.animationDuration = `${duration}s`;
        }

        // å•Ÿå‹•ï¼
        fetchMessages();

        // é¸ç”¨ï¼šæ¯ 5 åˆ†é˜é‡æ–°æŠ“å–ä¸€æ¬¡è³‡æ–™ (50000 æ¯«ç§’)
        setInterval(fetchMessages, 50000);

    </script>
</body>
</html>
